<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>[NDIR] (ENG) Hard-negative Mining for Mir-Flickr 1M Dataset | YANG’s note</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="[NDIR] (ENG) Hard-negative Mining for Mir-Flickr 1M Dataset" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="NDIR tech review" />
<meta property="og:description" content="NDIR tech review" />
<link rel="canonical" href="https://ndo04343.github.io/blog/near-duplicate%20image%20detection/tech-review/2022/03/21/(eng)hard-negative-mining-for-mir-flickr-1m-dataset.html" />
<meta property="og:url" content="https://ndo04343.github.io/blog/near-duplicate%20image%20detection/tech-review/2022/03/21/(eng)hard-negative-mining-for-mir-flickr-1m-dataset.html" />
<meta property="og:site_name" content="YANG’s note" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-21T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="[NDIR] (ENG) Hard-negative Mining for Mir-Flickr 1M Dataset" />
<script type="application/ld+json">
{"url":"https://ndo04343.github.io/blog/near-duplicate%20image%20detection/tech-review/2022/03/21/(eng)hard-negative-mining-for-mir-flickr-1m-dataset.html","@type":"BlogPosting","headline":"[NDIR] (ENG) Hard-negative Mining for Mir-Flickr 1M Dataset","dateModified":"2022-03-21T00:00:00-05:00","datePublished":"2022-03-21T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ndo04343.github.io/blog/near-duplicate%20image%20detection/tech-review/2022/03/21/(eng)hard-negative-mining-for-mir-flickr-1m-dataset.html"},"description":"NDIR tech review","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://ndo04343.github.io/blog/feed.xml" title="YANG's note" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">YANG&#39;s note</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/reports/">Reports</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/self-reflection/">Self-Reflection</a><a class="page-link" href="/blog/categories/">Categories</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">[NDIR] (ENG) Hard-negative Mining for Mir-Flickr 1M Dataset</h1><p class="page-description">NDIR tech review</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-03-21T00:00:00-05:00" itemprop="datePublished">
        Mar 21, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#near-duplicate image detection">near-duplicate image detection</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#tech-review">tech-review</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/(eng)hard-negative-mining-for-mir-flickr-1m-dataset.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-Overview">1. Overview<a class="anchor-link" href="#1.-Overview"> </a></h1><p><strong>Hard-negative mining</strong> is one of <strong>sampling method</strong> that is usually used in object detection task. The hard-negative sample means <strong>difficult</strong> negative data like not high distance value but it is negative samples. Therefore, the hard-negative mining pick first hard-negative samples.<br /><br /></p>
<p>In near-duplicate image retrieval task, it means that the method firstly choose the hard-negative pair. As a representative example, following paper used this method.</p>
<blockquote><p>2019, Expert Systems and Applications, Lia Morra, "Benchmarking Unsupervised Near-Duplicate Image Detection"</p>
</blockquote>
<p>In above paper, they have to use Mir-Flickr 1M dataset which contain one million images. Generally, when we solve the ndir task by agglomeraive hierachical clustering algorithm, we have to use very big memory space, and also it takes at least $O(n^3)$ time complexity. Although we use parallel computing, that cannot be implemented. First of all, we can substitute clustering to binary classification task to solve clustering problem. If there are $n$ numbers of data, it can be $n \choose 2$ numbers of pair which can be classified to ND or NND. If that is ND, it can be 1, or not 0. Following paper used this method.</p>
<blockquote><p>2020, Mathematics, Zhili Zhou, "Near-Duplicate Image Detection System Using Coarse-to-Fine Matching Scheme Based on Global and Local CNN Features"</p>
</blockquote>
<p>In above method, we need to consider transivity property for each pairs. If there ise cluster which is classified ND, every elements satisfy transivity property in cluster. However, in binary classification problem,</p>
$$
\text{If} \,\ _{I_i} \text{ND}_{I_j} \,\ \text{and} \,\ _{I_j} \text{ND}_{I_k}, \,\ \text{then} \,\ 
$$<p>$(I_i, I_k)$ is not ND pair generally. In contrast, it is more general case, therefore we can consider it can be used.<br /><br /></p>
<p>What is left is the time complexity. The number of MFND dataset is 10e6 and the number of pairs is 4.999995e11. From now on, we will consider hard-negative mining algorithm to approximate score.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-Hard-negative-mining-for-MFND-dataset">2. Hard-negative mining for MFND dataset<a class="anchor-link" href="#2.-Hard-negative-mining-for-MFND-dataset"> </a></h1><ul>
<li>Extract randomly selected query images and a compact set of NND from a large image collection that does not contain any near-duplicate match for each query image and element of collection.<ul>
<li>EX) Extract $K = 4400$ numbers of randomly selected query images and $M = 80000$ numbers of element to create a compact set from $1,000,000$ numbers of dataset.</li>
</ul>
</li>
<li>For each query image, we can compute distance with all of data in collection, and it will be $K \times M$ matrix.</li>
<li>For each row, extract NND pair which have minimum distance in that row. ($hn_1$)<ul>
<li>EX) $|hn_1| = 4400$</li>
</ul>
</li>
<li>For each sorted row, extract K-nearest neighbors from query image. ($hn_2$)    <ul>
<li>EX) $|hn_2| = 4400 \times 5$</li>
</ul>
</li>
</ul>
<blockquote><p>$hn_2$ is more "difficult" sample than $hn_1$.</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Commnets">Commnets<a class="anchor-link" href="#Commnets"> </a></h1><ul>
<li>It seems like a good way to deal with really large datasets like MFND in parallel and in parallel. </li>
<li>This is a method of selecting a negative sample, and it should not be confused with selecting a sample that is well representative of the distribution.</li>
<li>It is a simple and good method, but it seems to be a bad method under the assumption that the concept of ND can be extended to IND and NIND. Expansion of this concept may define a new concept that can quantitatively evaluate the degree from Duplicate to NND.</li>
</ul>

</div>
</div>
</div>
</div>





  </div><a class="u-url" href="/blog/near-duplicate%20image%20detection/tech-review/2022/03/21/(eng)hard-negative-mining-for-mir-flickr-1m-dataset.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Heesung Yang&#39;s note</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/ndo04343" target="_blank" title="ndo04343"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
